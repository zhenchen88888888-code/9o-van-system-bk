{"generator":"Code Snippets v3.7.0","date_created":"2025-09-13 04:54","snippets":[{"id":38,"name":"Charter Mobile Floating Price Bar","code":"add_action('wp_head', function() {\n    global $post;\n    $content = isset($post->post_content) ? $post->post_content : '';\n    \n    if (!is_page('\u5305\u8eca\u65c5\u904a\u9810\u7d04') && !is_page('charter-booking') && !has_shortcode($content, 'charter_booking_form')) {\n        return;\n    }\n    ?>\n    \n    <style type=\"text\/css\">\n    \/* ========================================\n       \u624b\u6a5f\u7248\u6d6e\u52d5\u50f9\u683c\u6b04\n       ======================================== *\/\n    @media (max-width: 1024px) {\n        .mobile-floating-price {\n            position: fixed;\n            bottom: 0;\n            left: 0;\n            right: 0;\n            background: white;\n            border-top: 2px solid #94989C;\n            box-shadow: 0 -4px 20px rgba(0,0,0,0.15);\n            z-index: 9999;\n            transform: translateY(100%);\n            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n            display: none;\n        }\n        \n        .mobile-floating-price.active {\n            display: block;\n            transform: translateY(0);\n        }\n        \n        \/* \u4e3b\u8981\u5167\u5bb9\u5340 *\/\n        .mobile-price-main {\n            padding: 12px 15px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            background: white;\n            position: relative;\n        }\n        \n        \/* \u50f9\u683c\u8cc7\u8a0a *\/\n        .mobile-price-info {\n            flex: 1;\n            display: flex;\n            align-items: center;\n            gap: 15px;\n        }\n        \n        .mobile-price-total {\n            display: flex;\n            flex-direction: column;\n            gap: 2px;\n        }\n        \n        .mobile-price-label {\n            font-size: 11px;\n            color: #5C5854;\n            font-weight: 500;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n        }\n        \n        .mobile-price-amount {\n            font-size: 22px;\n            font-weight: bold;\n            color: #94989C;\n            line-height: 1;\n        }\n        \n        \/* \u8a02\u91d1\u6a19\u7c64 *\/\n        .mobile-deposit-tag {\n            background: #FEF3C7;\n            color: #92400e;\n            padding: 5px 10px;\n            border-radius: 20px;\n            font-size: 12px;\n            font-weight: 500;\n            white-space: nowrap;\n        }\n        \n        .mobile-deposit-tag strong {\n            color: #b45309;\n            font-weight: 700;\n        }\n        \n        \/* \u5c55\u958b\u6309\u9215 *\/\n        .mobile-expand-btn {\n            width: 36px;\n            height: 36px;\n            background: #94989C;\n            color: white;\n            border: none;\n            border-radius: 50%;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            cursor: pointer;\n            transition: all 0.2s;\n            font-size: 14px;\n        }\n        \n        .mobile-expand-btn:active {\n            transform: scale(0.95);\n            background: #7a7e82;\n        }\n        \n        .mobile-expand-btn.expanded {\n            transform: rotate(180deg);\n        }\n        \n        \/* \u8a73\u7d30\u5167\u5bb9\u5340 *\/\n        .mobile-price-details {\n            max-height: 0;\n            overflow: hidden;\n            transition: max-height 0.3s ease;\n            background: #F5F2EE;\n            border-top: 1px solid #D4CFC4;\n        }\n        \n        .mobile-price-details.show {\n            max-height: 250px;\n            overflow-y: auto;\n        }\n        \n        .mobile-details-content {\n            padding: 15px;\n        }\n        \n        .mobile-detail-row {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 8px 0;\n            font-size: 13px;\n            border-bottom: 1px dashed #D4CFC4;\n        }\n        \n        .mobile-detail-row:last-child {\n            border-bottom: none;\n        }\n        \n        .mobile-detail-row.highlight {\n            background: #FEF3C7;\n            padding: 8px 10px;\n            margin: 5px -10px;\n            border-radius: 6px;\n            border-bottom: none;\n        }\n        \n        .mobile-detail-label {\n            color: #5C5854;\n            font-weight: 500;\n        }\n        \n        .mobile-detail-value {\n            color: #3C3834;\n            font-weight: 600;\n        }\n        \n        \/* \u8f09\u5165\u72c0\u614b *\/\n        .mobile-price-loading {\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 8px;\n            padding: 15px;\n            color: #5C5854;\n            font-size: 13px;\n        }\n        \n        .mobile-price-loading .spinner {\n            width: 14px;\n            height: 14px;\n            border: 2px solid rgba(148,152,156,0.2);\n            border-top-color: #94989C;\n            border-radius: 50%;\n            animation: spin 0.8s linear infinite;\n        }\n        \n        \/* \u50f9\u683c\u66f4\u65b0\u52d5\u756b *\/\n        @keyframes price-pop {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.08); }\n            100% { transform: scale(1); }\n        }\n        \n        .price-updating {\n            animation: price-pop 0.3s ease;\n        }\n        \n        \/* \u8abf\u6574\u4e3b\u5167\u5bb9\u5e95\u90e8\u9593\u8ddd *\/\n        #charter-booking-app {\n            padding-bottom: 80px !important;\n        }\n        \n        \/* \u96b1\u85cf\u539f\u672c\u7684\u50f9\u683c\u9762\u677f\uff08\u624b\u6a5f\u7248\uff09 *\/\n        #price-panel {\n            display: none !important;\n        }\n    }\n    \n    \/* \u5c0f\u87a2\u5e55\u512a\u5316 *\/\n    @media (max-width: 380px) {\n        .mobile-price-info {\n            gap: 10px;\n        }\n        \n        .mobile-price-amount {\n            font-size: 18px;\n        }\n        \n        .mobile-deposit-tag {\n            font-size: 11px;\n            padding: 4px 8px;\n        }\n        \n        .mobile-expand-btn {\n            width: 32px;\n            height: 32px;\n            font-size: 12px;\n        }\n    }\n    <\/style>\n    \n    <?php\n}, 99);\n\n\/\/ \u4fee\u6539\u539f\u672c\u7684 JavaScript \u4f86\u52a0\u5165\u5168\u57df\u9264\u5b50\nadd_action('wp_footer', function() {\n    global $post;\n    $content = isset($post->post_content) ? $post->post_content : '';\n    \n    if (!is_page('\u5305\u8eca\u65c5\u904a\u9810\u7d04') && !is_page('charter-booking') && !has_shortcode($content, 'charter_booking_form')) {\n        return;\n    }\n    ?>\n    \n    <script type=\"text\/javascript\">\n    \/\/ \u5148\u5efa\u7acb\u5168\u57df\u7684\u50f9\u683c\u66f4\u65b0\u9264\u5b50\n    window.CharterPriceHooks = window.CharterPriceHooks || [];\n    \n    \/\/ \u4fee\u6539\u539f\u672c CharterBooking \u7684 displayPrice \u65b9\u6cd5\n    (function() {\n        \/\/ \u7b49\u5f85\u539f\u672c\u7684 CharterBooking \u8f09\u5165\n        var checkCharterBooking = setInterval(function() {\n            if (typeof jQuery !== 'undefined' && jQuery('#charter-booking-form').length > 0) {\n                clearInterval(checkCharterBooking);\n                \n                \/\/ Hook into AJAX calls\n                var originalAjax = jQuery.ajax;\n                jQuery.ajax = function(settings) {\n                    \/\/ \u6514\u622a\u50f9\u683c\u8a08\u7b97\u7684 AJAX \u8acb\u6c42\n                    if (settings.data && typeof settings.data === 'string' && \n                        settings.data.indexOf('action=calculate_charter_price') > -1) {\n                        \n                        var originalSuccess = settings.success;\n                        settings.success = function(response) {\n                            \/\/ \u547c\u53eb\u539f\u672c\u7684 success callback\n                            if (originalSuccess) {\n                                originalSuccess.apply(this, arguments);\n                            }\n                            \n                            \/\/ \u89f8\u767c\u5168\u57df\u9264\u5b50\n                            if (response && response.success && response.data) {\n                                window.CharterPriceHooks.forEach(function(hook) {\n                                    if (typeof hook === 'function') {\n                                        hook(response.data);\n                                    }\n                                });\n                            }\n                        };\n                    }\n                    \n                    return originalAjax.apply(this, arguments);\n                };\n            }\n        }, 100);\n        \n        \/\/ 10\u79d2\u5f8c\u505c\u6b62\u6aa2\u67e5\n        setTimeout(function() { clearInterval(checkCharterBooking); }, 10000);\n    })();\n    <\/script>\n    \n    <!-- \u624b\u6a5f\u7248\u6d6e\u52d5\u50f9\u683c\u6b04 HTML -->\n    <div class=\"mobile-floating-price\" id=\"mobile-floating-price\">\n        <div class=\"mobile-price-main\">\n            <div class=\"mobile-price-info\">\n                <div class=\"mobile-price-total\">\n                    <span class=\"mobile-price-label\">\u7e3d\u8a08(\u542b\u7a05)<\/span>\n                    <span class=\"mobile-price-amount\" id=\"mobile-total-amount\">NT$ 0<\/span>\n                <\/div>\n                <div class=\"mobile-deposit-tag\">\n                    \u8a02\u91d1 <strong id=\"mobile-deposit-amount\">NT$ 0<\/strong>\n                <\/div>\n            <\/div>\n            <button class=\"mobile-expand-btn\" id=\"mobile-expand-btn\" aria-label=\"\u67e5\u770b\u660e\u7d30\">\n                \u25b2\n            <\/button>\n        <\/div>\n        \n        <div class=\"mobile-price-details\" id=\"mobile-price-details\">\n            <div class=\"mobile-details-content\" id=\"mobile-details-content\">\n                <div class=\"mobile-price-loading\">\n                    <span class=\"spinner\"><\/span>\n                    <span>\u8f09\u5165\u4e2d...<\/span>\n                <\/div>\n            <\/div>\n        <\/div>\n    <\/div>\n    \n    <script type=\"text\/javascript\">\n    (function($) {\n        'use strict';\n        \n        \/\/ \u624b\u6a5f\u7248\u6d6e\u52d5\u50f9\u683c\u6b04\u63a7\u5236\u5668\n        window.MobileFloatingPrice = {\n            isInitialized: false,\n            isExpanded: false,\n            \n            init: function() {\n                \/\/ \u53ea\u5728\u624b\u6a5f\u7248\u521d\u59cb\u5316\n                if (window.innerWidth > 1024) return;\n                \n                if (this.isInitialized) return;\n                this.isInitialized = true;\n                \n                console.log('\u521d\u59cb\u5316\u624b\u6a5f\u7248\u6d6e\u52d5\u50f9\u683c\u6b04');\n                \n                \/\/ \u5ef6\u9072\u986f\u793a\uff0c\u7b49\u5f85\u9801\u9762\u8f09\u5165\n                setTimeout(function() {\n                    $('#mobile-floating-price').addClass('active');\n                }, 500);\n                \n                \/\/ \u7d81\u5b9a\u5c55\u958b\/\u6536\u5408\u6309\u9215\n                $('#mobile-expand-btn').on('click', function() {\n                    window.MobileFloatingPrice.toggleDetails();\n                });\n                \n                \/\/ \u8a3b\u518a\u50f9\u683c\u66f4\u65b0\u9264\u5b50\n                window.CharterPriceHooks = window.CharterPriceHooks || [];\n                window.CharterPriceHooks.push(function(data) {\n                    console.log('\u50f9\u683c\u66f4\u65b0:', data);\n                    window.MobileFloatingPrice.update(data);\n                });\n                \n                \/\/ \u76e3\u807d\u8996\u7a97\u5927\u5c0f\u8b8a\u5316\n                $(window).on('resize', function() {\n                    if (window.innerWidth > 1024) {\n                        $('#mobile-floating-price').removeClass('active');\n                    } else {\n                        $('#mobile-floating-price').addClass('active');\n                    }\n                });\n            },\n            \n            toggleDetails: function() {\n                this.isExpanded = !this.isExpanded;\n                var $btn = $('#mobile-expand-btn');\n                var $details = $('#mobile-price-details');\n                \n                if (this.isExpanded) {\n                    $btn.addClass('expanded');\n                    $details.addClass('show');\n                } else {\n                    $btn.removeClass('expanded');\n                    $details.removeClass('show');\n                }\n            },\n            \n            update: function(data) {\n                if (!data) return;\n                \n                console.log('\u66f4\u65b0\u6d6e\u52d5\u50f9\u683c\u6b04:', data);\n                \n                \/\/ \u66f4\u65b0\u7e3d\u50f9\n                var total = data.total || 0;\n                var deposit = data.deposit || 0;\n                \n                var $totalAmount = $('#mobile-total-amount');\n                var $depositAmount = $('#mobile-deposit-amount');\n                \n                $totalAmount.text('NT$ ' + total.toLocaleString());\n                $depositAmount.text('NT$ ' + deposit.toLocaleString());\n                \n                \/\/ \u52a0\u5165\u66f4\u65b0\u52d5\u756b\n                $totalAmount.addClass('price-updating');\n                setTimeout(function() {\n                    $totalAmount.removeClass('price-updating');\n                }, 300);\n                \n                \/\/ \u66f4\u65b0\u660e\u7d30\n                this.updateDetails(data);\n            },\n            \n            updateDetails: function(data) {\n                var breakdown = data.breakdown || {};\n                var html = '';\n                \n                \/\/ \u57fa\u672c\u8cbb\u7528\n                if (breakdown.base_price > 0) {\n                    html += '<div class=\"mobile-detail-row\">' +\n                        '<span class=\"mobile-detail-label\">\u57fa\u672c\u8cbb\u7528 (' + data.trip_days + '\u5929)<\/span>' +\n                        '<span class=\"mobile-detail-value\">NT$ ' + breakdown.base_price.toLocaleString() + '<\/span>' +\n                        '<\/div>';\n                }\n                \n                \/\/ \u5c71\u5340\u52a0\u50f9\n                if (breakdown.mountain_surcharge > 0) {\n                    html += '<div class=\"mobile-detail-row highlight\">' +\n                        '<span class=\"mobile-detail-label\">\u26f0\ufe0f \u5c71\u5340\u670d\u52d9\u8cbb<\/span>' +\n                        '<span class=\"mobile-detail-value\">NT$ ' + breakdown.mountain_surcharge.toLocaleString() + '<\/span>' +\n                        '<\/div>';\n                }\n                \n                \/\/ \u53f8\u6a5f\u88dc\u8cbc\n                if (breakdown.driver_allowance > 0) {\n                    html += '<div class=\"mobile-detail-row\">' +\n                        '<span class=\"mobile-detail-label\">\u53f8\u6a5f\u88dc\u8cbc<\/span>' +\n                        '<span class=\"mobile-detail-value\">NT$ ' + breakdown.driver_allowance.toLocaleString() + '<\/span>' +\n                        '<\/div>';\n                }\n                \n                \/\/ \u52a0\u8cfc\u9805\u76ee\n                if (breakdown.addon_charge > 0) {\n                    html += '<div class=\"mobile-detail-row\">' +\n                        '<span class=\"mobile-detail-label\">\u52a0\u8cfc\u9805\u76ee<\/span>' +\n                        '<span class=\"mobile-detail-value\">NT$ ' + breakdown.addon_charge.toLocaleString() + '<\/span>' +\n                        '<\/div>';\n                }\n                \n                \/\/ \u7e3d\u8a08\n                html += '<div class=\"mobile-detail-row\" style=\"margin-top: 10px; padding-top: 10px; border-top: 2px solid #D4CFC4;\">' +\n                    '<span class=\"mobile-detail-label\" style=\"font-weight: 600;\">\u7e3d\u8a08 (\u542b\u7a055%)<\/span>' +\n                    '<span class=\"mobile-detail-value\" style=\"color: #94989C; font-size: 15px;\">NT$ ' + \n                    (data.total || 0).toLocaleString() + '<\/span>' +\n                    '<\/div>';\n                \n                $('#mobile-details-content').html(html);\n            }\n        };\n        \n        \/\/ DOM Ready\n        $(document).ready(function() {\n            \/\/ \u521d\u59cb\u5316\u624b\u6a5f\u7248\u6d6e\u52d5\u50f9\u683c\u6b04\n            window.MobileFloatingPrice.init();\n        });\n        \n    })(jQuery);\n    <\/script>\n    \n    <?php\n}, 101); \/\/ \u78ba\u4fdd\u5728\u539f\u672c\u7684 JavaScript \u4e4b\u5f8c\u57f7\u884c","scope":"front-end","active":true,"priority":15,"modified":"2025-09-12 11:46:13","revision":"1"}]}