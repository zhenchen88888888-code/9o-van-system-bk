{"generator":"Code Snippets v3.7.0","date_created":"2025-09-13 04:54","snippets":[{"id":39,"name":"Airport Mobile Floating Price Bar","code":"add_action('wp_head', function() {\n    global $post;\n    $content = isset($post->post_content) ? $post->post_content : '';\n    \n    if (!is_page('\u6a5f\u5834\u63a5\u9001\u9810\u7d04') && !is_page('airport-booking') && !has_shortcode($content, 'airport_booking_form')) {\n        return;\n    }\n    ?>\n    \n    <style type=\"text\/css\">\n    \/* ========================================\n       \u624b\u6a5f\u7248\u6d6e\u52d5\u50f9\u683c\u6b04 - \u6a5f\u5834\u63a5\u9001\u5c08\u7528\n       ======================================== *\/\n    @media (max-width: 1024px) {\n        .airport-mobile-price {\n            position: fixed;\n            bottom: 0;\n            left: 0;\n            right: 0;\n            background: white;\n            border-top: 2px solid #94989C;\n            box-shadow: 0 -4px 20px rgba(0,0,0,0.15);\n            z-index: 9999;\n            transform: translateY(100%);\n            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n            display: none;\n        }\n        \n        .airport-mobile-price.active {\n            display: block;\n            transform: translateY(0);\n        }\n        \n        \/* \u4e3b\u8981\u5167\u5bb9\u5340 *\/\n        .airport-price-main {\n            padding: 12px 15px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            background: white;\n            position: relative;\n        }\n        \n        \/* \u50f9\u683c\u8cc7\u8a0a *\/\n        .airport-price-info {\n            flex: 1;\n            display: flex;\n            align-items: center;\n            gap: 12px;\n        }\n        \n        .airport-price-total {\n            display: flex;\n            flex-direction: column;\n            gap: 2px;\n        }\n        \n        .airport-price-label {\n            font-size: 11px;\n            color: #5C5854;\n            font-weight: 500;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n        }\n        \n        .airport-price-amount {\n            font-size: 22px;\n            font-weight: bold;\n            color: #94989C;\n            line-height: 1;\n        }\n        \n        \/* \u6298\u6263\u6a19\u7c64 (\u4f86\u56de\u7a0b\u7528) *\/\n        .airport-discount-tag {\n            background: #10B981;\n            color: white;\n            padding: 5px 10px;\n            border-radius: 20px;\n            font-size: 12px;\n            font-weight: 500;\n            white-space: nowrap;\n            display: none;\n        }\n        \n        .airport-discount-tag.show {\n            display: block;\n        }\n        \n        .airport-discount-tag strong {\n            font-weight: 700;\n        }\n        \n        \/* \u5c55\u958b\u6309\u9215 *\/\n        .airport-expand-btn {\n            width: 36px;\n            height: 36px;\n            background: #94989C;\n            color: white;\n            border: none;\n            border-radius: 50%;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            cursor: pointer;\n            transition: all 0.2s;\n            font-size: 14px;\n        }\n        \n        .airport-expand-btn:active {\n            transform: scale(0.95);\n            background: #7a7e82;\n        }\n        \n        .airport-expand-btn.expanded {\n            transform: rotate(180deg);\n        }\n        \n        \/* \u8a73\u7d30\u5167\u5bb9\u5340 *\/\n        .airport-price-details {\n            max-height: 0;\n            overflow: hidden;\n            transition: max-height 0.3s ease;\n            background: #F5F2EE;\n            border-top: 1px solid #D4CFC4;\n        }\n        \n        .airport-price-details.show {\n            max-height: 300px;\n            overflow-y: auto;\n        }\n        \n        .airport-details-content {\n            padding: 15px;\n        }\n        \n        .airport-detail-row {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 8px 0;\n            font-size: 13px;\n            border-bottom: 1px dashed #D4CFC4;\n        }\n        \n        .airport-detail-row:last-child {\n            border-bottom: none;\n        }\n        \n        .airport-detail-row.highlight {\n            background: #FEF3C7;\n            padding: 8px 10px;\n            margin: 5px -10px;\n            border-radius: 6px;\n            border-bottom: none;\n        }\n        \n        .airport-detail-row.remote {\n            background: #FEE2E2;\n            padding: 8px 10px;\n            margin: 5px -10px;\n            border-radius: 6px;\n            border-bottom: none;\n        }\n        \n        .airport-detail-label {\n            color: #5C5854;\n            font-weight: 500;\n        }\n        \n        .airport-detail-value {\n            color: #3C3834;\n            font-weight: 600;\n        }\n        \n        \/* \u505c\u9760\u9ede\u660e\u7d30 *\/\n        .stopover-mini-details {\n            margin-top: 5px;\n            padding-left: 10px;\n            font-size: 11px;\n            color: #6B7280;\n        }\n        \n        \/* \u8f09\u5165\u72c0\u614b *\/\n        .airport-price-loading {\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 8px;\n            padding: 15px;\n            color: #5C5854;\n            font-size: 13px;\n        }\n        \n        .airport-price-loading .spinner {\n            width: 14px;\n            height: 14px;\n            border: 2px solid rgba(148,152,156,0.2);\n            border-top-color: #94989C;\n            border-radius: 50%;\n            animation: spin 0.8s linear infinite;\n        }\n        \n        \/* \u50f9\u683c\u66f4\u65b0\u52d5\u756b *\/\n        @keyframes price-pop {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.08); }\n            100% { transform: scale(1); }\n        }\n        \n        .price-updating {\n            animation: price-pop 0.3s ease;\n        }\n        \n        \/* \u8abf\u6574\u4e3b\u5167\u5bb9\u5e95\u90e8\u9593\u8ddd *\/\n        #airport-booking-app {\n            padding-bottom: 80px !important;\n        }\n        \n        \/* \u96b1\u85cf\u539f\u672c\u7684\u50f9\u683c\u9762\u677f\uff08\u624b\u6a5f\u7248\uff09 *\/\n        #price-panel {\n            display: none !important;\n        }\n    }\n    \n    \/* \u5c0f\u87a2\u5e55\u512a\u5316 *\/\n    @media (max-width: 380px) {\n        .airport-price-info {\n            gap: 8px;\n        }\n        \n        .airport-price-amount {\n            font-size: 18px;\n        }\n        \n        .airport-discount-tag {\n            font-size: 11px;\n            padding: 4px 8px;\n        }\n        \n        .airport-expand-btn {\n            width: 32px;\n            height: 32px;\n            font-size: 12px;\n        }\n        \n        .airport-detail-row {\n            font-size: 12px;\n        }\n    }\n    <\/style>\n    \n    <?php\n}, 99);\n\n\/\/ JavaScript \u90e8\u5206\nadd_action('wp_footer', function() {\n    global $post;\n    $content = isset($post->post_content) ? $post->post_content : '';\n    \n    if (!is_page('\u6a5f\u5834\u63a5\u9001\u9810\u7d04') && !is_page('airport-booking') && !has_shortcode($content, 'airport_booking_form')) {\n        return;\n    }\n    ?>\n    \n    <script type=\"text\/javascript\">\n    \/\/ \u5efa\u7acb\u5168\u57df\u7684\u50f9\u683c\u66f4\u65b0\u9264\u5b50\n    window.AirportPriceHooks = window.AirportPriceHooks || [];\n    \n    \/\/ \u4fee\u6539\u539f\u672c AirportBooking \u7684 calculatePrice \u65b9\u6cd5\n    (function() {\n        \/\/ \u7b49\u5f85\u539f\u672c\u7684 AirportBooking \u8f09\u5165\n        var checkAirportBooking = setInterval(function() {\n            if (typeof jQuery !== 'undefined' && jQuery('#airport-booking-form').length > 0) {\n                clearInterval(checkAirportBooking);\n                \n                \/\/ Hook into AJAX calls\n                var originalAjax = jQuery.ajax;\n                jQuery.ajax = function(settings) {\n                    \/\/ \u6514\u622a\u50f9\u683c\u8a08\u7b97\u7684 AJAX \u8acb\u6c42\n                    if (settings.data && typeof settings.data === 'string' && \n                        settings.data.indexOf('action=calculate_airport_price') > -1) {\n                        \n                        var originalSuccess = settings.success;\n                        settings.success = function(response) {\n                            \/\/ \u547c\u53eb\u539f\u672c\u7684 success callback\n                            if (originalSuccess) {\n                                originalSuccess.apply(this, arguments);\n                            }\n                            \n                            \/\/ \u89f8\u767c\u5168\u57df\u9264\u5b50\n                            if (response && response.success && response.data) {\n                                window.AirportPriceHooks.forEach(function(hook) {\n                                    if (typeof hook === 'function') {\n                                        hook(response.data);\n                                    }\n                                });\n                            }\n                        };\n                    }\n                    \n                    return originalAjax.apply(this, arguments);\n                };\n            }\n        }, 100);\n        \n        \/\/ 10\u79d2\u5f8c\u505c\u6b62\u6aa2\u67e5\n        setTimeout(function() { clearInterval(checkAirportBooking); }, 10000);\n    })();\n    <\/script>\n    \n    <!-- \u624b\u6a5f\u7248\u6d6e\u52d5\u50f9\u683c\u6b04 HTML -->\n    <div class=\"airport-mobile-price\" id=\"airport-mobile-price\">\n        <div class=\"airport-price-main\">\n            <div class=\"airport-price-info\">\n                <div class=\"airport-price-total\">\n                    <span class=\"airport-price-label\">\u7e3d\u8a08(\u542b\u7a05)<\/span>\n                    <span class=\"airport-price-amount\" id=\"airport-total-amount\">NT$ 0<\/span>\n                <\/div>\n                <div class=\"airport-discount-tag\" id=\"airport-discount-tag\">\n                    <strong>9\u6298\u512a\u60e0<\/strong>\n                <\/div>\n            <\/div>\n            <button class=\"airport-expand-btn\" id=\"airport-expand-btn\" aria-label=\"\u67e5\u770b\u660e\u7d30\">\n                \u25b2\n            <\/button>\n        <\/div>\n        \n        <div class=\"airport-price-details\" id=\"airport-price-details\">\n            <div class=\"airport-details-content\" id=\"airport-details-content\">\n                <div class=\"airport-price-loading\">\n                    <span class=\"spinner\"><\/span>\n                    <span>\u8f09\u5165\u4e2d...<\/span>\n                <\/div>\n            <\/div>\n        <\/div>\n    <\/div>\n    \n    <script type=\"text\/javascript\">\n    (function($) {\n        'use strict';\n        \n        \/\/ \u624b\u6a5f\u7248\u6d6e\u52d5\u50f9\u683c\u6b04\u63a7\u5236\u5668\n        window.AirportMobilePrice = {\n            isInitialized: false,\n            isExpanded: false,\n            lastData: null,\n            \n            init: function() {\n                \/\/ \u53ea\u5728\u624b\u6a5f\u7248\u521d\u59cb\u5316\n                if (window.innerWidth > 1024) return;\n                \n                if (this.isInitialized) return;\n                this.isInitialized = true;\n                \n                console.log('\u521d\u59cb\u5316\u6a5f\u5834\u63a5\u9001\u624b\u6a5f\u7248\u6d6e\u52d5\u50f9\u683c\u6b04');\n                \n                \/\/ \u5ef6\u9072\u986f\u793a\uff0c\u7b49\u5f85\u9801\u9762\u8f09\u5165\n                setTimeout(function() {\n                    $('#airport-mobile-price').addClass('active');\n                }, 500);\n                \n                \/\/ \u7d81\u5b9a\u5c55\u958b\/\u6536\u5408\u6309\u9215\n                $('#airport-expand-btn').on('click', function() {\n                    window.AirportMobilePrice.toggleDetails();\n                });\n                \n                \/\/ \u8a3b\u518a\u50f9\u683c\u66f4\u65b0\u9264\u5b50\n                window.AirportPriceHooks = window.AirportPriceHooks || [];\n                window.AirportPriceHooks.push(function(data) {\n                    console.log('\u6a5f\u5834\u63a5\u9001\u50f9\u683c\u66f4\u65b0:', data);\n                    window.AirportMobilePrice.update(data);\n                });\n                \n                \/\/ \u76e3\u807d\u8996\u7a97\u5927\u5c0f\u8b8a\u5316\n                $(window).on('resize', function() {\n                    if (window.innerWidth > 1024) {\n                        $('#airport-mobile-price').removeClass('active');\n                    } else {\n                        $('#airport-mobile-price').addClass('active');\n                    }\n                });\n            },\n            \n            toggleDetails: function() {\n                this.isExpanded = !this.isExpanded;\n                var $btn = $('#airport-expand-btn');\n                var $details = $('#airport-price-details');\n                \n                if (this.isExpanded) {\n                    $btn.addClass('expanded');\n                    $details.addClass('show');\n                } else {\n                    $btn.removeClass('expanded');\n                    $details.removeClass('show');\n                }\n            },\n            \n            update: function(data) {\n                if (!data) return;\n                \n                this.lastData = data;\n                console.log('\u66f4\u65b0\u6a5f\u5834\u63a5\u9001\u6d6e\u52d5\u50f9\u683c\u6b04:', data);\n                \n                \/\/ \u66f4\u65b0\u7e3d\u50f9\n                var total = data.total || 0;\n                var $totalAmount = $('#airport-total-amount');\n                \n                $totalAmount.text('NT$ ' + total.toLocaleString());\n                \n                \/\/ \u52a0\u5165\u66f4\u65b0\u52d5\u756b\n                $totalAmount.addClass('price-updating');\n                setTimeout(function() {\n                    $totalAmount.removeClass('price-updating');\n                }, 300);\n                \n                \/\/ \u6aa2\u67e5\u662f\u5426\u6709\u6298\u6263\uff08\u4f86\u56de\u7a0b\uff09\n                var hasDiscount = data.breakdown && data.breakdown.discount && data.breakdown.discount < 0;\n                if (hasDiscount) {\n                    $('#airport-discount-tag').addClass('show');\n                } else {\n                    $('#airport-discount-tag').removeClass('show');\n                }\n                \n                \/\/ \u66f4\u65b0\u660e\u7d30\n                this.updateDetails(data);\n            },\n            \n            updateDetails: function(data) {\n                var breakdown = data.breakdown || {};\n                var html = '';\n                \n                \/\/ \u57fa\u672c\u8cbb\u7528\n                if (breakdown.base_price > 0) {\n                    html += '<div class=\"airport-detail-row\">' +\n                        '<span class=\"airport-detail-label\">\u57fa\u672c\u8cbb\u7528<\/span>' +\n                        '<span class=\"airport-detail-value\">NT$ ' + breakdown.base_price.toLocaleString() + '<\/span>' +\n                        '<\/div>';\n                }\n                \n                \/\/ \u591c\u9593\u52a0\u50f9\n                if (breakdown.night_surcharge > 0) {\n                    html += '<div class=\"airport-detail-row highlight\">' +\n                        '<span class=\"airport-detail-label\">\ud83c\udf19 \u591c\u9593\u52a0\u50f9<\/span>' +\n                        '<span class=\"airport-detail-value\">NT$ ' + breakdown.night_surcharge.toLocaleString() + '<\/span>' +\n                        '<\/div>';\n                }\n                \n                \/\/ \u504f\u9060\u5730\u5340\u52a0\u50f9\n                if (breakdown.remote_surcharge > 0) {\n                    html += '<div class=\"airport-detail-row remote\">' +\n                        '<span class=\"airport-detail-label\">\ud83d\udccd \u504f\u9060\u5730\u5340\u52a0\u50f9<\/span>' +\n                        '<span class=\"airport-detail-value\">NT$ ' + breakdown.remote_surcharge.toLocaleString() + '<\/span>' +\n                        '<\/div>';\n                }\n                \n                \/\/ \u505c\u9760\u9ede\u8cbb\u7528\n                if (breakdown.stopover_charge > 0) {\n                    html += '<div class=\"airport-detail-row\">' +\n                        '<span class=\"airport-detail-label\">\u505c\u9760\u9ede\u8cbb\u7528<\/span>' +\n                        '<span class=\"airport-detail-value\">NT$ ' + breakdown.stopover_charge.toLocaleString() + '<\/span>' +\n                        '<\/div>';\n                    \n                    \/\/ \u986f\u793a\u505c\u9760\u9ede\u6578\u91cf\n                    if (breakdown.stopover_details && breakdown.stopover_details.length > 0) {\n                        var chargedStops = breakdown.stopover_details.filter(function(d) { return d.charged; }).length;\n                        if (chargedStops > 0) {\n                            html += '<div class=\"stopover-mini-details\">' +\n                                '\u542b ' + chargedStops + ' \u500b\u8a08\u8cbb\u505c\u9760\u9ede' +\n                                '<\/div>';\n                        }\n                    }\n                }\n                \n                \/\/ \u52a0\u8cfc\u9805\u76ee\n                if (breakdown.addon_charge > 0) {\n                    html += '<div class=\"airport-detail-row\">' +\n                        '<span class=\"airport-detail-label\">\u52a0\u8cfc\u9805\u76ee<\/span>' +\n                        '<span class=\"airport-detail-value\">NT$ ' + breakdown.addon_charge.toLocaleString() + '<\/span>' +\n                        '<\/div>';\n                    \n                    \/\/ \u8209\u724c\u670d\u52d9\n                    if (breakdown.name_board_charge > 0) {\n                        html += '<div class=\"stopover-mini-details\">\u542b\u8209\u724c\u670d\u52d9<\/div>';\n                    }\n                }\n                \n                \/\/ \u56de\u7a0b\u8cbb\u7528\uff08\u5982\u679c\u662f\u4f86\u56de\u7a0b\uff09\n                if (breakdown.return_subtotal !== undefined) {\n                    html += '<div class=\"airport-detail-row\" style=\"margin-top: 10px; padding-top: 10px; border-top: 2px solid #D4CFC4;\">' +\n                        '<span class=\"airport-detail-label\" style=\"font-weight: 600;\">\u56de\u7a0b\u8cbb\u7528<\/span>' +\n                        '<span class=\"airport-detail-value\">NT$ ' + breakdown.return_subtotal.toLocaleString() + '<\/span>' +\n                        '<\/div>';\n                    \n                    \/\/ \u56de\u7a0b\u504f\u9060\u5730\u5340\u52a0\u50f9\n                    if (breakdown.return_remote_surcharge > 0) {\n                        html += '<div class=\"airport-detail-row remote\">' +\n                            '<span class=\"airport-detail-label\">\ud83d\udccd \u56de\u7a0b\u504f\u9060\u52a0\u50f9<\/span>' +\n                            '<span class=\"airport-detail-value\">NT$ ' + breakdown.return_remote_surcharge.toLocaleString() + '<\/span>' +\n                            '<\/div>';\n                    }\n                    \n                    \/\/ \u56de\u7a0b\u505c\u9760\u9ede\n                    if (breakdown.return_stopover_charge > 0) {\n                        html += '<div class=\"airport-detail-row\">' +\n                            '<span class=\"airport-detail-label\">\u56de\u7a0b\u505c\u9760\u9ede<\/span>' +\n                            '<span class=\"airport-detail-value\">NT$ ' + breakdown.return_stopover_charge.toLocaleString() + '<\/span>' +\n                            '<\/div>';\n                    }\n                    \n                    \/\/ \u539f\u59cb\u7e3d\u50f9\uff08\u6298\u6263\u524d\uff09\n                    if (breakdown.original_total !== undefined) {\n                        html += '<div class=\"airport-detail-row\">' +\n                            '<span class=\"airport-detail-label\">\u539f\u59cb\u7e3d\u50f9<\/span>' +\n                            '<span class=\"airport-detail-value\" style=\"text-decoration: line-through; color: #999;\">' +\n                            'NT$ ' + breakdown.original_total.toLocaleString() + '<\/span>' +\n                            '<\/div>';\n                    }\n                    \n                    \/\/ \u4f86\u56de\u6298\u6263\n                    if (breakdown.discount && breakdown.discount < 0) {\n                        html += '<div class=\"airport-detail-row\" style=\"color: #16a34a;\">' +\n                            '<span class=\"airport-detail-label\" style=\"font-weight: 600;\">\u2728 \u4f86\u56de\u7a0b9\u6298\u512a\u60e0<\/span>' +\n                            '<span class=\"airport-detail-value\" style=\"color: #16a34a;\">' +\n                            '-NT$ ' + Math.abs(breakdown.discount).toLocaleString() + '<\/span>' +\n                            '<\/div>';\n                    }\n                }\n                \n                \/\/ \u7e3d\u8a08\n                html += '<div class=\"airport-detail-row\" style=\"margin-top: 10px; padding-top: 10px; border-top: 2px solid #D4CFC4;\">' +\n                    '<span class=\"airport-detail-label\" style=\"font-weight: 600;\">\u7e3d\u8a08 (\u542b\u7a055%)<\/span>' +\n                    '<span class=\"airport-detail-value\" style=\"color: #94989C; font-size: 15px;\">NT$ ' + \n                    (data.total || 0).toLocaleString() + '<\/span>' +\n                    '<\/div>';\n                \n                $('#airport-details-content').html(html);\n            }\n        };\n        \n        \/\/ DOM Ready\n        $(document).ready(function() {\n            \/\/ \u521d\u59cb\u5316\u624b\u6a5f\u7248\u6d6e\u52d5\u50f9\u683c\u6b04\n            window.AirportMobilePrice.init();\n        });\n        \n    })(jQuery);\n    <\/script>\n    \n    <?php\n}, 101); \/\/ \u78ba\u4fdd\u5728\u539f\u672c\u7684 JavaScript \u4e4b\u5f8c\u57f7\u884c","scope":"front-end","active":true,"priority":14,"modified":"2025-09-12 15:31:06","revision":"1"}]}